---
title: "Project 3: Genome Scale algorithms"
author: "Maria, Mateo and Jacob"
date: "2/20/2018"
output:
  pdf_document:
  variant: markdown_github
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggpubr)
library(tidyverse)
```
Instruction of the project: https://github.com/mailund/gsa-exercises/tree/master/Project04

##Project 4 - Suffix arrays and BW-match

## Program description

The programs are implemented in Python (2.7) and we had no unsolved issues implementing the algorithms.
Execution of the programs on command line takes the form:

```{r, engine = 'python', eval = FALSE, python.reticulate = F}
python search-bs.py [text-filename] [pattern]
python search-bw.py [text-filename] [pattern]
```

The program outputs positions where the second parameter (patern) occurs in the text from file. The positions are sorted by index of occurence and if the pattern does not exist in the text *None* is returned.

##Problems
We did not have any problems regarding implementation except Radix sort. Since sorting suffixes using radix sort requieres creating a 'bucket' for each letter in alphabet and taking ASCII values of letters we could end up with potential problems. Each letter in character coresponds to a integer value called ASCII value but special scharacters could not be found there, which can cause problems when trying to sort them using radix sort. Also implementation of radix sort 


## Evauluation
We measured time for both, search using Burrows-Wheeler transformation and binary search and following plots are showing the results.
```{r}
bin_search = read.csv("time_binary_search.csv", header = T)
bwt_search = read.csv("time_bwt_search.csv", header = T)

ggplot(data = bin_search) + 
        geom_point(mapping = aes(y = time/(m*log(n)), x = n, color = scenario)) + 
        labs(x = "n", y = "Time/mlog(n)") +
        ylim(0,2.5e-08) + 
        xlim(0,10000) + 
        ggtitle("Time measures for Binary search comparing two scenarios") +
        theme_bw()
 
ggplot(data = bwt_search) + 
        geom_point(mapping = aes(y = time/m, x = n, color = scenario)) +
        labs(x = "n", y = "Time/m") +
        ylim(0,1.5e-07) + 
        xlim(0,10000) + 
        ggtitle("Time measures for BWT search comparing two scenarios") +
        theme_bw()
```


## Test of correctness
We used the test data provided in testdata.zip to test the correctness of the program.

## Time complexity of sorting (python sort and radix sort)

```{r}

radix = read.csv("time_radix.csv", header = T)
sorted = read.csv("time_sorted.csv", header = T)

```



